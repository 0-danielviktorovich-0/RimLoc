<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>RimLoc GUI</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="overlay" class="overlay hidden">
      <div class="overlay-card">
        <div class="spinner" aria-hidden="true"></div>
        <p id="overlay-text">Working…</p>
      </div>
    </div>
    <div id="toast" role="status" aria-live="polite"></div>

    <header>
      <div>
        <h1 data-i18n="title">RimLoc GUI</h1>
        <p class="subtitle" data-i18n="subtitle">Desktop companion for RimLoc services</p>
      </div>
      <div class="header-meta">
        <span id="app-version"></span>
        <span id="status-text"></span>
      </div>
    </header>

    <main>
      <section class="panel" id="progress-panel">
        <div class="panel-head">
          <h2 data-i18n="progress">Progress</h2>
        </div>
        <div id="progress-items" class="progress-items"></div>
      </section>
      <section class="panel" id="settings-panel">
        <div class="panel-head">
          <h2 data-i18n="settings">Settings</h2>
          <div class="actions">
            <button id="open-debug-modal" type="button" data-i18n="open_debug">Debug…</button>
          </div>
        </div>
        <div class="field-grid">
          <label>
            <span data-i18n="language">Language</span>
            <select id="locale-select">
              <option value="auto" data-i18n="lang.auto">Auto</option>
              <option value="en">English</option>
              <option value="ru">Русский</option>
            </select>
          </label>
          <label>
            <span data-i18n="theme">Theme</span>
            <select id="theme-select">
              <option value="auto" data-i18n="theme.auto">Auto</option>
              <option value="light" data-i18n="theme.light">Light</option>
              <option value="dark" data-i18n="theme.dark">Dark</option>
            </select>
          </label>
          
        </div>
      </section>
      <section class="panel" id="mod-setup">
        <h2 data-i18n="mod_setup">Mod setup</h2>
        <p class="hint" data-i18n="mod_setup_hint">Choose the mod folder and optional game version. Values are stored locally for convenience.</p>
        <div class="field-group">
          <label for="mod-root" data-i18n="mod_root">Mod root</label>
          <div class="path-input">
            <input id="mod-root" type="text" placeholder="/path/to/mod" autocomplete="off" />
            <button type="button" data-action="pick-root" data-i18n="browse">Browse…</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="game_version">Game version (optional)
            <input id="game-version" type="text" placeholder="e.g. 1.5" autocomplete="off" />
          </label>
          <label data-i18n="target_lang">
            <input id="target-lang" type="text" placeholder="ru" autocomplete="off" />
          </label>
          <label data-i18n="source_lang">
            <input id="source-lang" type="text" placeholder="auto" autocomplete="off" />
          </label>
        </div>
      </section>

      <section class="panel" id="preview-panel">
        <div class="panel-head">
          <h2 data-i18n="preview_title">Preview EN → Target</h2>
          <div class="actions">
            <input id="preview-filter" type="text" placeholder="filter keys…" />
            <label>
              <input id="preview-missing-only" type="checkbox" />
              <span data-i18n="preview_missing_only">Missing only</span>
            </label>
          </div>
        </div>
        <div class="split">
          <div class="col">
            <div class="table-wrapper" style="max-height: 240px">
              <table>
                <thead>
                  <tr>
                    <th scope="col">Key</th>
                    <th scope="col">EN</th>
                    <th scope="col">Target</th>
                  </tr>
                </thead>
                <tbody id="preview-keys"></tbody>
              </table>
            </div>
          </div>
          <div class="col">
            <div class="two-pane">
              <div>
                <h3>EN</h3>
                <pre class="code" id="preview-en"></pre>
              </div>
              <div>
                <h3>Target</h3>
                <pre class="code" id="preview-target"></pre>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="panel" id="scan-panel">
        <div class="panel-head">
          <h2 data-i18n="scan_title">Scan Keyed &amp; DefInjected</h2>
          <div class="actions">
            <button type="button" id="scan-run" data-i18n="scan_run">Run scan</button>
            <button type="button" id="scan-save-json" data-i18n="scan_save_json">Save JSON…</button>
            <button type="button" id="scan-save-csv" data-i18n="scan_save_csv">Save CSV…</button>
          </div>
        </div>
        <div class="field-grid">
          <label>
            <input id="scan-all-versions" type="checkbox" />
            <span data-i18n="scan_all_versions">Include all versions under root</span>
          </label>
          <label data-i18n="defs_root">Defs root (optional)
            <div class="path-input">
              <input id="scan-defs-root" type="text" placeholder="/path/to/Defs" autocomplete="off" />
              <button type="button" data-action="pick-scan-defs" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label data-i18n="extra_fields">Extra fields (comma-separated)
            <input id="scan-extra-fields" type="text" placeholder="label,description" autocomplete="off" />
          </label>
          <label>
            <span>Defs dictionaries (one per line)</span>
            <textarea id="scan-defs-dicts" rows="3" placeholder="/path/to/dict.json\n/path/to/another.json"></textarea>
          </label>
          <label>
            <span data-i18n="type_schema">Type schema (optional)</span>
            <div class="path-input">
              <input id="scan-type-schema" type="text" placeholder="/path/to/schema.json" autocomplete="off" />
              <button type="button" data-action="pick-scan-schema" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label>
            <input id="scan-keyed-nested" type="checkbox" />
            <span>Nested Keyed (dot-paths)</span>
          </label>
          <label>
            <input id="scan-no-inherit" type="checkbox" />
            <span>No inheritance</span>
          </label>
          <label>
            <input id="scan-with-plugins" type="checkbox" />
            <span>Run plugins</span>
          </label>
        </div>
        <div class="scan-summary" id="scan-summary" data-i18n="scan_empty">No scan performed yet.</div>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th scope="col" data-i18n="th_key">Key</th>
                <th scope="col" data-i18n="th_kind">Kind</th>
                <th scope="col" data-i18n="th_source">Source sample</th>
                <th scope="col" data-i18n="th_path">Path</th>
                <th scope="col" data-i18n="th_line">Line</th>
              </tr>
            </thead>
            <tbody id="scan-table-body"></tbody>
          </table>
        </div>
      </section>

      <section class="panel" id="learn-panel">
        <div class="panel-head">
          <h2 data-i18n="learn_title">Learn DefInjected</h2>
          <div class="actions">
            <button type="button" id="learn-run" data-i18n="learn_run">Learn defs</button>
            <button type="button" id="learn-open-out" disabled data-i18n="open_output">Open output</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="out_folder">
            <div class="path-input">
              <input id="learn-out" type="text" placeholder="_learn" autocomplete="off" />
              <button type="button" data-action="pick-learn-out" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label data-i18n="source_lang_folder">
            <input id="learn-lang-dir" type="text" placeholder="English" autocomplete="off" />
          </label>
          <label>
            <span>Threshold</span>
            <input id="learn-threshold" type="number" step="0.05" min="0" max="1" placeholder="0.8" autocomplete="off" />
          </label>
        </div>
        <div class="result" id="learn-result" data-i18n="learn_empty">No learn run yet.</div>
      </section>

      <section class="panel" id="export-panel">
        <div class="panel-head">
          <h2 data-i18n="export_title">Export PO</h2>
          <div class="actions">
            <button type="button" id="export-run" data-i18n="export_run">Export PO</button>
            <button type="button" id="export-open-file" disabled data-i18n="open_file">Open file</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="po_out_file">
            <div class="path-input">
              <input id="po-output" type="text" placeholder="_learn/mod.po" autocomplete="off" />
              <button type="button" data-action="pick-po-output" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label data-i18n="tm_folders">
            <textarea id="tm-roots" rows="3" placeholder="/path/to/reference-mod"></textarea>
          </label>
          <label data-i18n="source_lang_folder">
            <input id="export-source-lang-dir" type="text" placeholder="English" autocomplete="off" />
          </label>
          <label>
            <input id="export-pot" type="checkbox" />
            <span data-i18n="export_pot">Write POT (template)</span>
          </label>
          <label>
            <input id="export-all-versions" type="checkbox" />
            <span data-i18n="scan_all_versions">Include all versions under root</span>
          </label>
        </div>
        <div class="result" id="export-result" data-i18n="export_empty">No export performed yet.</div>
      </section>

      <section class="panel" id="validate-panel">
        <div class="panel-head">
          <h2 data-i18n="validate_title">Validate</h2>
          <div class="actions">
            <button type="button" id="validate-run" data-i18n="validate_run">Run validate</button>
            <button type="button" id="validate-save" data-i18n="save_report">Save report…</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="source_lang">Source language code
            <input id="validate-source-lang" type="text" placeholder="auto" autocomplete="off" />
          </label>
          <label data-i18n="source_lang_folder">
            <input id="validate-source-lang-dir" type="text" placeholder="English" autocomplete="off" />
          </label>
          <label data-i18n="defs_root">
            <div class="path-input">
              <input id="validate-defs-root" type="text" placeholder="/path/to/Defs" autocomplete="off" />
              <button type="button" data-action="pick-validate-defs" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label data-i18n="extra_fields">
            <input id="validate-extra-fields" type="text" placeholder="label,description" autocomplete="off" />
          </label>
          <label>
            <span>Defs dictionaries (one per line)</span>
            <textarea id="validate-defs-dicts" rows="3" placeholder="/path/to/dict.json\n/path/to/another.json"></textarea>
          </label>
          <label>
            <span>Type schema (optional)</span>
            <div class="path-input">
              <input id="validate-type-schema" type="text" placeholder="/path/to/schema.json" autocomplete="off" />
              <button type="button" data-action="pick-validate-schema" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label>
            <input id="validate-all-versions" type="checkbox" />
            <span data-i18n="scan_all_versions">Include all versions under root</span>
          </label>
          <label>
            <input id="validate-compare-ph" type="checkbox" />
            <span data-i18n="validate_compare_ph">Compare placeholders EN↔Target</span>
          </label>
          <label data-i18n="target_lang">Target language code
            <input id="validate-target-lang" type="text" placeholder="ru" autocomplete="off" />
          </label>
          <label data-i18n="target_lang_folder">
            <input id="validate-target-lang-dir" type="text" placeholder="Russian" autocomplete="off" />
          </label>
        </div>
        <div class="result" id="validate-result" data-i18n="validate_empty">No validation run yet.</div>
      </section>

      <section class="panel" id="health-panel">
        <div class="panel-head">
          <h2 data-i18n="health_title">XML Health</h2>
          <div class="actions">
            <button type="button" id="health-run" data-i18n="health_run">Check</button>
            <button type="button" id="health-save" data-i18n="save_report">Save report…</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="source_lang_folder">
            <input id="health-lang-dir" type="text" placeholder="English" autocomplete="off" />
          </label>
          <label>
            <input id="health-strict" type="checkbox" />
            <span data-i18n="health_strict">Strict mode (non-empty=error)</span>
          </label>
          <label>
            <span data-i18n="health_only">Only categories</span>
            <input id="health-only" type="text" placeholder="duplicate,empty,placeholder-check" autocomplete="off" />
          </label>
          <label>
            <span data-i18n="health_except">Except categories</span>
            <input id="health-except" type="text" placeholder="placeholder-check" autocomplete="off" />
          </label>
        </div>
        <div class="result" id="health-result" data-i18n="health_empty">No health check yet.</div>
      </section>

      <section class="panel" id="import-panel">
        <div class="panel-head">
          <h2 data-i18n="import_title">Import PO → XML</h2>
          <div class="actions">
            <button type="button" id="import-run" data-i18n="import_run">Import PO</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="po_file">PO file
            <div class="path-input">
              <input id="import-po" type="text" placeholder="/path/to/translation.po" autocomplete="off" />
              <button type="button" data-action="pick-import-po" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label data-i18n="target_lang_folder">Target language folder
            <input id="import-lang-dir" type="text" placeholder="Russian" autocomplete="off" />
          </label>
          <label id="import-out-xml-wrap" style="display:none">
            <span>Output XML path</span>
            <div class="path-input">
              <input id="import-out-xml" type="text" placeholder="/path/to/_Imported.xml" autocomplete="off" />
              <button type="button" data-action="pick-import-out-xml" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label>
            <input id="import-single-file" type="checkbox" />
            <span data-i18n="import_single_file">Single file (_Imported.xml)</span>
          </label>
          <label>
            <input id="import-incremental" type="checkbox" />
            <span data-i18n="import_incremental">Incremental (skip identical)</span>
          </label>
          <label>
            <input id="import-keep-empty" type="checkbox" />
            <span data-i18n="import_keep_empty">Keep empty entries</span>
          </label>
          <label>
            <input id="import-backup" type="checkbox" />
            <span data-i18n="backup">Backup existing</span>
          </label>
          <label>
            <input id="import-only-diff" type="checkbox" />
            <span data-i18n="import_only_diff">Only changed keys</span>
          </label>
          <label>
            <input id="import-report" type="checkbox" />
            <span data-i18n="import_report">Print summary report</span>
          </label>
          <label>
            <input id="import-dry-run" type="checkbox" />
            <span data-i18n="dry_run">Dry run</span>
          </label>
        </div>
        <div class="result" id="import-result" data-i18n="import_empty">No import performed yet.</div>
      </section>

      <section class="panel" id="build-panel">
        <div class="panel-head">
          <h2 data-i18n="build_title">Build Translation Mod</h2>
          <div class="actions">
            <button type="button" id="build-run" data-i18n="build_run">Build</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="po_file">PO file
            <div class="path-input">
              <input id="build-po" type="text" placeholder="/path/to/translation.po" autocomplete="off" />
              <button type="button" data-action="pick-build-po" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label>
            <span data-i18n="from_root">From existing root (optional)</span>
            <div class="path-input">
              <input id="build-from-root" type="text" placeholder="/path/to/mod-or-lang-root" autocomplete="off" />
              <button type="button" data-action="pick-build-from-root" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label>
            <span data-i18n="from_versions">Only game versions (comma-separated)</span>
            <input id="build-from-versions" type="text" placeholder="1.5,1.6" autocomplete="off" />
          </label>
          <label data-i18n="out_folder">
            <div class="path-input">
              <input id="build-out" type="text" placeholder="/path/to/mod-out" autocomplete="off" />
              <button type="button" data-action="pick-build-out" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label data-i18n="target_lang_folder">Target language folder
            <input id="build-lang-dir" type="text" placeholder="Russian" autocomplete="off" />
          </label>
          <label>
            <span data-i18n="mod_name">Mod name</span>
            <input id="build-name" type="text" placeholder="RimLoc Translation" autocomplete="off" />
          </label>
          <label>
            <span data-i18n="package_id">Package ID</span>
            <input id="build-package" type="text" placeholder="your.name.rimloc" autocomplete="off" />
          </label>
          <label>
            <span data-i18n="rw_version">RimWorld version</span>
            <input id="build-rw" type="text" placeholder="1.5" autocomplete="off" />
          </label>
          <label>
            <input id="build-dedupe" type="checkbox" />
            <span data-i18n="build_dedupe">Dedupe keys</span>
          </label>
          <label>
            <input id="build-dry" type="checkbox" />
            <span data-i18n="dry_run">Dry run</span>
          </label>
        </div>
        <div class="result" id="build-result" data-i18n="build_empty">No build performed yet.</div>
      </section>

      <section class="panel" id="diff-panel">
        <div class="panel-head">
          <h2 data-i18n="diff_title">Diff XML</h2>
          <div class="actions">
            <button type="button" id="diff-run" data-i18n="diff_run">Run diff</button>
            <button type="button" id="diff-save" data-i18n="save_report">Save report…</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="source_lang_folder">
            <input id="diff-source-lang-dir" type="text" placeholder="English" autocomplete="off" />
          </label>
          <label data-i18n="target_lang_folder">
            <input id="diff-target-lang-dir" type="text" placeholder="Russian" autocomplete="off" />
          </label>
          <label data-i18n="defs_root">Defs root (optional)
            <div class="path-input">
              <input id="diff-defs-root" type="text" placeholder="/path/to/Defs" autocomplete="off" />
              <button type="button" data-action="pick-diff-defs" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label data-i18n="po_file">Baseline PO (optional)
            <div class="path-input">
              <input id="diff-po" type="text" placeholder="/path/to/baseline.po" autocomplete="off" />
              <button type="button" data-action="pick-diff-po" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label>
            <span>Defs dictionaries (one per line)</span>
            <textarea id="diff-defs-dicts" rows="3" placeholder="/path/to/dict.json\n/path/to/another.json"></textarea>
          </label>
          <label>
            <span>Type schema (optional)</span>
            <div class="path-input">
              <input id="diff-type-schema" type="text" placeholder="/path/to/schema.json" autocomplete="off" />
              <button type="button" data-action="pick-diff-schema" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label data-i18n="extra_fields">Extra fields (comma-separated)
            <input id="diff-extra-fields" type="text" placeholder="label,description" autocomplete="off" />
          </label>
        </div>
        <div class="result" id="diff-result" data-i18n="diff_empty">No diff run yet.</div>
      </section>

      <section class="panel" id="morph-panel">
        <div class="panel-head">
          <h2>Morph (Cases/Plural/Gender)</h2>
          <div class="actions">
            <button type="button" id="morph-run">Generate</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="target_lang_folder">Target language folder
            <input id="morph-target-lang-dir" type="text" placeholder="Russian" autocomplete="off" />
          </label>
          <label>
            <span data-i18n="morph_provider">Provider</span>
            <select id="morph-provider">
              <option value="dummy">Dummy</option>
              <option value="morpher">MorpherApi</option>
              <option value="pymorphy">Pymorphy2</option>
            </select>
          </label>
          <label>
            <span data-i18n="morph_token">Morpher token</span>
            <input id="morph-token" type="password" placeholder="MORPHER_TOKEN" autocomplete="off" />
          </label>
          <label>
            <span data-i18n="morph_filter">Filter key regex</span>
            <input id="morph-filter" type="text" placeholder=".*" autocomplete="off" />
          </label>
          <label>
            <span>Limit</span>
            <input id="morph-limit" type="number" placeholder="" autocomplete="off" />
          </label>
          <label>
            <span data-i18n="timeout_ms">Timeout, ms</span>
            <input id="morph-timeout" type="number" placeholder="1500" autocomplete="off" />
          </label>
          <label>
            <span data-i18n="cache_size">Cache size</span>
            <input id="morph-cache" type="number" placeholder="1024" autocomplete="off" />
          </label>
          <label>
            <span data-i18n="pymorphy_url">Pymorphy URL</span>
            <input id="morph-pym-url" type="text" placeholder="http://localhost:5000" autocomplete="off" />
          </label>
        </div>
        <div class="result" id="morph-result">—</div>
      </section>

      <section class="panel" id="learn-keyed-panel">
        <div class="panel-head">
          <h2>Learn Keyed</h2>
          <div class="actions">
            <button type="button" id="learn-keyed-run">Run</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="out_folder">Output folder
            <div class="path-input">
              <input id="learn-keyed-out" type="text" placeholder="_learn" autocomplete="off" />
              <button type="button" data-action="pick-learn-keyed-out" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label data-i18n="source_lang_folder">Source language folder
            <input id="learn-keyed-source" type="text" placeholder="English" autocomplete="off" />
          </label>
          <label data-i18n="target_lang_folder">Target language folder
            <input id="learn-keyed-target" type="text" placeholder="Russian" autocomplete="off" />
          </label>
          <label>
            <span>Threshold</span>
            <input id="learn-keyed-threshold" type="number" step="0.05" min="0" max="1" placeholder="0.8" autocomplete="off" />
          </label>
          <label>
            <span data-i18n="dict_files">Dict files (one per line)</span>
            <textarea id="learn-keyed-dicts" rows="3" placeholder="/path/to/dict.json\n/path/to/another.json"></textarea>
          </label>
          <label>
            <span data-i18n="blacklist">Blacklist (one per line)</span>
            <textarea id="learn-keyed-blacklist" rows="3" placeholder="prefix_.*\n^Key$"></textarea>
          </label>
          <label>
            <span data-i18n="exclude_substrings">Exclude substrings (one per line)</span>
            <textarea id="learn-keyed-exclude" rows="3" placeholder="TODO\nWIP"></textarea>
          </label>
          <label>
            <span data-i18n="min_length">Min length</span>
            <input id="learn-keyed-minlen" type="number" placeholder="1" />
          </label>
          <label>
            <input id="learn-keyed-must-letter" type="checkbox" />
            <span data-i18n="must_letter">Must contain letter</span>
          </label>
          <label>
            <input id="learn-keyed-from-defs" type="checkbox" />
            <span data-i18n="from_defs">From Defs (special)</span>
          </label>
        </div>
        <div class="result" id="learn-keyed-result">—</div>
      </section>

      <section class="panel" id="schemas-panel">
        <div class="panel-head">
          <h2 data-i18n="schemas_title">JSON Schemas</h2>
          <div class="actions">
            <button type="button" id="schemas-dump" data-i18n="schemas_dump">Dump schemas…</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="out_folder">
            <div class="path-input">
              <input id="schemas-out" type="text" placeholder="./docs/assets/schemas" autocomplete="off" />
              <button type="button" data-action="pick-schemas-out" data-i18n="browse">Browse…</button>
            </div>
          </label>
        </div>
        <div class="result" id="schemas-result">—</div>
      </section>

      <section class="panel" id="lang-update-panel">
        <div class="panel-head">
          <h2 data-i18n="lang_update_title">Lang Update</h2>
          <div class="actions">
            <button type="button" id="lang-update-run" data-i18n="lang_update_run">Update</button>
          </div>
        </div>
        <div class="field-grid">
          <label><span data-i18n="game_root">Game root (folder with Data)</span>
            <div class="path-input">
              <input id="lang-update-game-root" type="text" placeholder="/path/to/RimWorld" autocomplete="off" />
              <button type="button" data-action="pick-lang-update-root" data-i18n="browse">Browse…</button>
            </div>
          </label>
          <label><span data-i18n="repo">Repo</span>
            <input id="lang-update-repo" type="text" placeholder="Ludeon/RimWorld" autocomplete="off" />
          </label>
          <label><span data-i18n="branch">Branch</span>
            <input id="lang-update-branch" type="text" placeholder="master" autocomplete="off" />
          </label>
          <label data-i18n="source_lang_folder">Source language folder
            <input id="lang-update-source" type="text" placeholder="English" autocomplete="off" />
          </label>
          <label data-i18n="target_lang_folder">Target language folder
            <input id="lang-update-target" type="text" placeholder="Russian" autocomplete="off" />
          </label>
          <label>
            <input id="lang-update-dry" type="checkbox" />
            <span data-i18n="dry_run">Dry run</span>
          </label>
          <label>
            <input id="lang-update-backup" type="checkbox" />
            <span data-i18n="backup">Backup existing</span>
          </label>
        </div>
        <div class="result" id="lang-update-result" data-i18n="lang_update_empty">No lang update yet.</div>
      </section>

      <section class="panel" id="annotate-panel">
        <div class="panel-head">
          <h2 data-i18n="annotate_title">Annotate Keyed</h2>
          <div class="actions">
            <button type="button" id="annotate-preview" data-i18n="annotate_preview">Preview</button>
            <button type="button" id="annotate-apply" data-i18n="annotate_apply">Apply</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="source_lang_folder">Source language folder
            <input id="annotate-source" type="text" placeholder="English" autocomplete="off" />
          </label>
          <label data-i18n="target_lang_folder">Target language folder
            <input id="annotate-target" type="text" placeholder="Russian" autocomplete="off" />
          </label>
          <label>
            <span>Prefix</span>
            <input id="annotate-prefix" type="text" placeholder="//" autocomplete="off" />
          </label>
          <label>
            <input id="annotate-strip" type="checkbox" />
            <span data-i18n="strip_comments">Strip existing comments</span>
          </label>
          <label>
            <input id="annotate-backup" type="checkbox" />
            <span data-i18n="backup">Backup files</span>
          </label>
        </div>
        <div class="result" id="annotate-result" data-i18n="annotate_empty">No annotate yet.</div>
      </section>

      <section class="panel" id="init-panel">
        <div class="panel-head">
          <h2 data-i18n="init_title">Init Language</h2>
          <div class="actions">
            <button type="button" id="init-run" data-i18n="init_run">Init</button>
          </div>
        </div>
        <div class="field-grid">
          <label data-i18n="source_lang_folder">Source language folder
            <input id="init-source" type="text" placeholder="English" autocomplete="off" />
          </label>
          <label data-i18n="target_lang_folder">Target language folder
            <input id="init-target" type="text" placeholder="Russian" autocomplete="off" />
          </label>
          <label>
            <input id="init-overwrite" type="checkbox" />
            <span data-i18n="overwrite">Overwrite existing</span>
          </label>
          <label>
            <input id="init-dry" type="checkbox" />
            <span data-i18n="dry_run">Dry run</span>
          </label>
        </div>
        <div class="result" id="init-result" data-i18n="init_empty">No init yet.</div>
      </section>

      <section class="panel" id="debug-panel">
        <div class="panel-head">
          <h2 data-i18n="debug_console">Debug console</h2>
          <div class="actions">
            <button type="button" id="debug-clear" data-i18n="clear">Clear</button>
          </div>
        </div>
        <pre id="debug-log" class="debug-log" aria-live="polite"></pre>
      </section>

      <div id="debug-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="debug-modal-title">
        <div class="modal-card">
          <div class="modal-head">
            <h3 id="debug-modal-title" data-i18n="debug_modal_title">Diagnostics</h3>
            <button type="button" id="debug-modal-close">✕</button>
          </div>
          <div class="modal-body">
            <p data-i18n="debug_modal_hint">Copy errors or share with maintainer. Log file:</p>
            <div class="path-row">
              <code id="log-path">…</code>
              <div class="path-actions">
                <button id="copy-log-path" type="button" data-i18n="copy">Copy</button>
                <button id="open-log-folder" type="button" data-i18n="open_folder">Open folder</button>
                <button id="save-console" type="button" data-i18n="save_console">Save console…</button>
                <button id="collect-diagnostics" type="button" data-i18n="collect_diag">Collect diagnostics…</button>
                <button id="simulate-error" type="button" data-i18n="simulate_error">Simulate error</button>
                <button id="simulate-panic" type="button" data-i18n="simulate_panic">Simulate panic</button>
              </div>
            </div>
            <div class="field-grid">
              <label>
                <span data-i18n="loglevel">Log level</span>
                <select id="log-level-modal">
                  <option value="info">info</option>
                  <option value="debug">debug</option>
                  <option value="trace">trace</option>
                </select>
              </label>
              <label>
                <input id="enable-backtrace" type="checkbox" />
                <span data-i18n="enable_backtrace">Enable Rust backtrace</span>
              </label>
            </div>
            <pre id="debug-modal-content" class="debug-log"></pre>
          </div>
        </div>
      </div>
    </main>

    <footer>
      <p data-i18n="footer_hint">Need DefInjected strings? Run “Learn defs” first and copy <code>suggested.xml</code> into your language folder.</p>
    </footer>

    <script src="index.js" defer></script>
  </body>
</html>
